(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cdae0e3a"],{"0ad4":function(t,e,a){},4194:function(t,e,a){"use strict";var n=a("1c8b"),r=a("5dfd").find,i=a("258f"),s=a("ff9c"),c="find",o=!0,d=s(c);c in[]&&Array(1)[c]((function(){o=!1})),n({target:"Array",proto:!0,forced:o||!d},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),i(c)},"4ae9":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"record-detail",attrs:{flex:""}},[a("div",{staticClass:"operate",attrs:{flex:""}},[a("div",{staticClass:"back",attrs:{flex:""},on:{click:function(e){return t.$router.push("/record")}}},[a("svg-icon",{attrs:{name:"back"}}),a("span",[t._v("返回")])],1),a("span",{staticClass:"state"},[t._v(t._s(t.saving.state))]),a("loading-button",{attrs:{loading:t.saving.b,text:"上传",icon:"save"},nativeOn:{click:function(e){return t.save(e)}}})],1),a("div",{staticClass:"time",attrs:{flex:""}},[a("span",[a("span",[t._v("创建:")]),t._v(t._s(t._f("time")(t.info?t.info.time:0,!1)))]),a("span",[a("span",[t._v("修改:")]),t._v(t._s(t._f("time")(t.info?t.info.modifyTime:0,!1)))])]),a("div",{staticClass:"edit"},[a("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"images",attrs:{flex:""}},[a("span",{staticClass:"head",attrs:{flex:""}},[a("svg-icon",{attrs:{name:"picture"}}),t._v(" 封面 ")],1),t._l(t.info.images,(function(e,n){return a("div",{key:e,staticClass:"item",attrs:{flex:""}},[a("loading-img",{attrs:{src:e,size:[12,8],"data-viewer":!0}}),a("label",{staticClass:"bottom",attrs:{flex:""}},[a("input",{attrs:{"data-idx":n},domProps:{value:e},on:{focusout:t.editImg}}),a("single-button",{staticClass:"del-btn",attrs:{text:"删除"},nativeOn:{click:function(e){return t.delImg(n)}}})],1)],1)})),a("span",{staticClass:"add",attrs:{flex:""},on:{click:t.addImg}},[a("svg-icon",{attrs:{name:"add"}})],1)],2),a("label",{staticClass:"text"},[a("span",[t._v("文本:")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}})])])])},r=[],i=(a("b4fb"),a("4194"),a("ea69"),a("e18c"),a("1c2e"),a("af86"),a("6a61"),a("cf7f")),s=a("8e8da"),c=a("7081"),o=a("2a7d"),d=a("fa7d"),u=a("82b2"),f={name:"RecordDetail",components:{SingleButton:o["a"],LoadingImg:c["a"],LoadingButton:s["a"]},props:{record:{type:Array,default:function(){return[]}}},data:function(){return{saving:{b:!1,state:""},tempRecord:[],text:"",info:{},newInfo:{file:"",time:0,modifyTime:0,summary:"",images:[]}}},computed:{id:function(){return this.$route.params.id},gitUtil:function(){return this._gitUtil()}},inject:["_gitUtil"],mounted:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:case"end":return e.stop()}}),e)})))()},watch:{"$props.record":function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:case"end":return e.stop()}}),e)})))()}},methods:{init:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.info=JSON.parse(JSON.stringify("new"===t.id?t.newInfo:t.record.find((function(e){return e.file===t.id}))||t.newInfo)),"new"===t.id){e.next=6;break}return e.next=4,Object(d["a"])("".concat(u["b"],"/record/").concat(t.id,".txt"));case 4:a=e.sent,a[0]?t.text=a[1]:t.$message.error(Object(d["d"])(a[1]));case 6:case"end":return e.stop()}}),e)})))()},delImg:function(t){this.info.images.splice(t,1)},editImg:function(t){this.info.images.splice(parseInt(t.target.getAttribute("data-idx")),1,t.target.value)},addImg:function(){this.info.images.push("")},save:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n,r,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.saving.b){e.next=2;break}return e.abrupt("return");case 2:if(!t.gitUtil){e.next=41;break}if(a=t.info,a.images.length){e.next=6;break}return e.abrupt("return",t.$message.warning("封面不能为空!"));case 6:t.saving={b:!0,state:"保存中..."},a.summary=t.text.substr(0,30)+(t.text.length>=30?"... ...":""),n=(new Date).getTime(),a.modifyTime=n,"new"!==t.id?n=t.id:(a.time=n,a.file=n.toString(),t.record.push(JSON.parse(JSON.stringify(a)))),e.t0=regeneratorRuntime.keys(t.record);case 12:if((e.t1=e.t0()).done){e.next=19;break}if(r=e.t1.value,t.record[r].file!==t.id){e.next=17;break}return t.record[r]=a,e.abrupt("break",19);case 17:e.next=12;break;case 19:return t.saving.state="更新:record.json",Object(d["e"])(t.record),e.next=23,t.gitUtil.updateJsonFile("record.json",t.record);case 23:if(i=e.sent,!i[0]){e.next=37;break}return e.next=27,t.gitUtil.updateRecord({file:n,txt:t.text},t.saving);case 27:if(s=e.sent,!s[0]){e.next=34;break}return t.$message.success("上传成功!"),e.next=32,t.$router.push("/record");case 32:e.next=35;break;case 34:t.$message.error(Object(d["d"])(s[1]));case 35:e.next=38;break;case 37:t.$message.error(Object(d["d"])(i[1]));case 38:t.saving={b:!1,state:""},e.next=43;break;case 41:t.$message.warning("请先登录!"),t.$emit("login");case 43:case"end":return e.stop()}}),e)})))()}}},l=f,g=(a("9d32"),a("9ca4")),m=Object(g["a"])(l,n,r,!1,null,"41fb6ca0",null);e["default"]=m.exports},5504:function(t,e,a){},7081:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"loading-img",style:t.calcStyle},[a("img",{class:{failed:t.failed},attrs:{"data-viewer":t.dataViewer,src:t.srcNow,alt:"img"},on:{load:t.loaded,error:t.errored,click:t.reload}}),t.loading?a("span",{attrs:{flex:""}},[a("svg-icon",{attrs:{name:"loading"}})],1):t._e()])},r=[],i=a("8f7d"),s=a.n(i),c={name:"LoadingImg",props:{src:{type:String,default:""},size:{type:Array,default:function(){return[8,8]}},dataViewer:{type:Boolean,default:!1}},data:function(){return{srcNow:this.src,loading:!0,failed:!1}},watch:{"$props.src":function(){this.srcNow=this.$props.src,this.failed=!1,this.loading=!0}},computed:{calcStyle:function(){var t={};return this.size[0]>0&&(t.width="".concat(this.size[0],"rem")),this.size[1]>0&&(t.height="".concat(this.size[1],"rem")),t}},methods:{loaded:function(){this.loading=!1},errored:function(){this.loading=!1,this.failed=!0,this.srcNow=s.a},reload:function(){this.failed&&(this.loading=!0,this.failed=!1,this.srcNow=this.src)}}},o=c,d=(a("c66d"),a("9ca4")),u=Object(d["a"])(o,n,r,!1,null,"509476a2",null);e["a"]=u.exports},"8f7d":function(t,e,a){t.exports=a.p+"img/error.0c3300aa.jpg"},"9d32":function(t,e,a){"use strict";var n=a("0ad4"),r=a.n(n);r.a},c66d:function(t,e,a){"use strict";var n=a("5504"),r=a.n(n);r.a}}]);